# –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–æ–≤–æ–º –ø–æ–∫—Ä—ã—Ç–∏–∏ Flutter-–∫–ª–∏–µ–Ω—Ç–∞ Orpheus

## üìä –ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã (–¥–æ —É–ª—É—á—à–µ–Ω–∏–π)
1. **call_protocol_test.dart** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∑–≤–æ–Ω–∫–æ–≤ (4 —Ç–µ—Å—Ç–∞)
2. **crypto_service_test.dart** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (2 —Ç–µ—Å—Ç–∞)
3. **database_test.dart** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (2 —Ç–µ—Å—Ç–∞)

### –ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
1. **–ú–æ–¥–µ–ª–∏:**
   - `test/models/chat_message_model_test.dart` - 7 —Ç–µ—Å—Ç–æ–≤
   - `test/models/contact_model_test.dart` - 7 —Ç–µ—Å—Ç–æ–≤

2. **–°–µ—Ä–≤–∏—Å—ã:**
   - `test/services/websocket_service_test.dart` - 8 —Ç–µ—Å—Ç–æ–≤
   - `test/services/sound_service_test.dart` - 4 —Ç–µ—Å—Ç–∞
   - `test/services/update_service_test.dart` - 2 —Ç–µ—Å—Ç–∞
   - `test/services/database_service_test.dart` - 10 —Ç–µ—Å—Ç–æ–≤

3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
   - `test/config_test.dart` - 8 —Ç–µ—Å—Ç–æ–≤

4. **–í–∏–¥–∂–µ—Ç—ã:**
   - `test/widgets/welcome_screen_test.dart` - 5 —Ç–µ—Å—Ç–æ–≤
   - `test/widgets/contacts_screen_test.dart` - 5 —Ç–µ—Å—Ç–æ–≤

### –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
1. **database_test.dart** - –†–∞—Å—à–∏—Ä–µ–Ω —Å 2 –¥–æ 9 —Ç–µ—Å—Ç–æ–≤ (–¥–æ–±–∞–≤–ª–µ–Ω—ã –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏)
2. **crypto_service_test.dart** - –†–∞—Å—à–∏—Ä–µ–Ω —Å 2 –¥–æ 9 —Ç–µ—Å—Ç–æ–≤ (–¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –æ—à–∏–±–æ–∫ –∏ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤)
3. **call_protocol_test.dart** - –†–∞—Å—à–∏—Ä–µ–Ω —Å 4 –¥–æ 10 —Ç–µ—Å—Ç–æ–≤ (–¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π)

## üìã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–æ–Ω—ã –±–µ–∑ —Ç–µ—Å—Ç–æ–≤

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏, —Ç—Ä–µ–±—É—é—â–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–≠–∫—Ä–∞–Ω—ã (Widget —Ç–µ—Å—Ç—ã):**
   - ‚úÖ `welcome_screen.dart` - –ø–æ–∫—Ä—ã—Ç
   - ‚úÖ `contacts_screen.dart` - –ø–æ–∫—Ä—ã—Ç
   - ‚ùå `chat_screen.dart` - **—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–æ–≤**
   - ‚ùå `call_screen.dart` - **—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–æ–≤** (—Å–ª–æ–∂–Ω—ã–π, —Å WebRTC)
   - ‚ùå `license_screen.dart` - **—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–æ–≤**
   - ‚ùå `qr_scan_screen.dart` - **—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–æ–≤**
   - ‚ùå `updates_screen.dart` - **—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–æ–≤**

2. **–°–µ—Ä–≤–∏—Å—ã (Unit —Ç–µ—Å—Ç—ã):**
   - ‚úÖ `crypto_service.dart` - –ø–æ–∫—Ä—ã—Ç
   - ‚úÖ `database_service.dart` - –ø–æ–∫—Ä—ã—Ç
   - ‚úÖ `websocket_service.dart` - –ø–æ–∫—Ä—ã—Ç (–±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã)
   - ‚úÖ `sound_service.dart` - –ø–æ–∫—Ä—ã—Ç
   - ‚úÖ `update_service.dart` - –ø–æ–∫—Ä—ã—Ç (–±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã)
   - ‚ùå `webrtc_service.dart` - **—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–æ–≤** (—Å–ª–æ–∂–Ω—ã–π, —Ç—Ä–µ–±—É–µ—Ç –º–æ–∫–æ–≤ WebRTC)
   - ‚ùå `notification_service.dart` - **—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–æ–≤** (—Ç—Ä–µ–±—É–µ—Ç –º–æ–∫–æ–≤ Firebase)

3. **–£—Ç–∏–ª–∏—Ç—ã:**
   - ‚úÖ `config.dart` - –ø–æ–∫—Ä—ã—Ç
   - ‚ùå `theme/app_theme.dart` - **—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–æ–≤**

## üéØ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤

### Unit-—Ç–µ—Å—Ç—ã (—á–∏—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞)
- ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (ChatMessage, Contact)
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (AppConfig)
- ‚úÖ –°–µ—Ä–≤–∏—Å—ã (Crypto, Database, WebSocket, Sound, Update)
- ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ: WebRTC, Notification (—Ç—Ä–µ–±—É—é—Ç —Å–ª–æ–∂–Ω—ã—Ö –º–æ–∫–æ–≤)

### Widget-—Ç–µ—Å—Ç—ã (UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- ‚úÖ WelcomeScreen
- ‚úÖ ContactsScreen
- ‚ùå ChatScreen
- ‚ùå CallScreen
- ‚ùå LicenseScreen
- ‚ùå QrScanScreen
- ‚ùå UpdatesScreen

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã (—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `integration_test`)

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É —Ç–µ—Å—Ç–æ–≤

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
```bash
flutter test
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã —Ç–µ—Å—Ç–æ–≤
```bash
# –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π
flutter test test/models/

# –¢–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤
flutter test test/services/

# –¢–µ—Å—Ç—ã –≤–∏–¥–∂–µ—Ç–æ–≤
flutter test test/widgets/

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
flutter test test/models/chat_message_model_test.dart
```

### –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
```bash
flutter test --coverage
genhtml coverage/lcov.info -o coverage/html
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CI/CD

### GitHub Actions –ø—Ä–∏–º–µ—Ä
```yaml
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.0.0'
      - run: flutter pub get
      - run: flutter test
      - run: flutter test --coverage
      - uses: codecov/codecov-action@v3
        with:
          files: coverage/lcov.info
```

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 8
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –º–æ–¥–µ–ª–µ–π:** 0%
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤:** ~40%
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –≤–∏–¥–∂–µ—Ç–æ–≤:** 0%
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** 0%

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** ~70+
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –º–æ–¥–µ–ª–µ–π:** 100%
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤:** ~85%
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –≤–∏–¥–∂–µ—Ç–æ–≤:** ~30%
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** 100%

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è ChatScreen:**
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–∞–≥—Ä—É–∑–∫–∏

2. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è CallScreen:**
   - –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ WebRTC —Å–µ—Ä–≤–∏—Å–∞
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–≤–æ–Ω–∫–∞
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤

3. **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:**
   - –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
   - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
   - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∑–≤–æ–Ω–∫–∞

4. **–£–ª—É—á—à–∏—Ç—å —Ç–µ—Å—Ç—ã WebRTC –∏ Notification:**
   - –°–æ–∑–¥–∞—Ç—å –º–æ–∫–∏ –¥–ª—è flutter_webrtc
   - –°–æ–∑–¥–∞—Ç—å –º–æ–∫–∏ –¥–ª—è Firebase Messaging

## üìö –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `sqflite_common_ffi` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î –≤ –ø–∞–º—è—Ç–∏
- CryptoService —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–æ–∫–∏ –¥–ª—è SecureStorage
- Widget —Ç–µ—Å—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Flutter binding
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç—ã –º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

- ‚úÖ –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–µ–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ widget-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫




