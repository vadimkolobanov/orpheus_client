# Архитектура клиента (кратко)

## Структура
- `lib/` — исходный код приложения
  - `screens/` — экраны приложения
  - `services/` — сервисы (websocket/webrtc/crypto/db/auth/уведомления и т.п.)
  - `models/` — модели данных
  - `theme/` — тема/стили
  - `widgets/` — переиспользуемые виджеты
- `test/` — unit/widget тесты
- `android/` — Android-часть (Gradle, манифесты, ресурсы)

## Ключевые сервисы
- `CryptoService` — генерация ключей X25519, шифрование ChaCha20-Poly1305
- `AuthService` — PIN-код, duress code, блокировка приложения
- `DatabaseService` — локальная SQLite база (контакты, сообщения)
- `WebSocketService` — связь с сервером
- `NotificationService` — push-уведомления
- `PanicWipeService` — экстренное удаление данных

## Принципы
- Сервисы не должны напрямую зависеть от UI.
- Изменения поведения всегда отражаем в:
  - `CHANGELOG.md` (Unreleased)
  - `AI_WORKLOG.md` (что/когда/какие файлы/какие команды)
  - `docs/*` (если меняется "как пользоваться" или "как работает")

## Где описывать важные решения
См. `docs/DECISIONS/` (ADR-заметки).

## Система безопасности
- PIN-код (6 цифр) — опциональная защита входа
- Duress code — второй PIN, показывающий пустой профиль
- Panic wipe — жест “3 ухода приложения в фон” (опционально) удаляет локальные данные
- Блокировка при сворачивании приложения
- См. `docs/DECISIONS/0003-security-system.md`


