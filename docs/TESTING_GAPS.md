# –ü—Ä–æ–±–µ–ª—ã –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –ø–æ–∫—Ä—ã—Ç–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞

## üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —Ç–æ—á–Ω—ã–µ —á–∏—Å–ª–∞ (—Ñ–∞–π–ª—ã/—Ç–µ—Å—Ç—ã/–ø–æ–∫—Ä—ã—Ç–∏–µ) –ª—É—á—à–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø—Ä–æ–≥–æ–Ω–∞ (`flutter test` / `.\test_runner.ps1`),
> —á—Ç–æ–±—ã –Ω–µ ‚Äú—Ä–∏—Å–æ–≤–∞—Ç—å‚Äù –º–µ—Ç—Ä–∏–∫–∏ —Ä—É–∫–∞–º–∏.

- **–§–æ–∫—É—Å**: –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è (unit) ‚Üí UI (widget) –≤—Ç–æ—Ä—ã–º —Å–ª–æ–µ–º.

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ —Ç–µ—Å—Ç–∞–º–∏)

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞**: 2025-12-27

### 2025-12-27
- ‚úÖ **AuthService (PIN/duress/wipe/auto-wipe/storage)** ‚Äî `test/services/auth_service_test.dart`
  - –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã: `success|invalid|lockedOut|duress|wipeCode|autoWipe`, storage roundtrip, safe-default –Ω–∞ –±–∏—Ç–æ–º –∫–æ–Ω—Ñ–∏–≥–µ.
- ‚úÖ **SecurityConfig (lockout ladder + —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è)** ‚Äî `test/models/security_config_test.dart`
  - Lockout –ª–µ—Å—Ç–Ω–∏—Ü–∞ –≤—ã—Ä–æ–≤–Ω–µ–Ω–∞ –ø–æ ADR 0003: 5‚Üí30s, 10‚Üí1m, 15‚Üí5m, 20‚Üí30m.
- ‚úÖ **PanicWipeService (3 —É—Ö–æ–¥–∞ –≤ —Ñ–æ–Ω –≤ –æ–∫–Ω–µ)** ‚Äî `test/services/panic_wipe_service_test.dart`
  - –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã: disabled‚Üí–Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç; 3 —Å–æ–±—ã—Ç–∏—è –≤ –æ–∫–Ω–µ‚Üíwipe; —Ä–∞–∑—Ä—ã–≤—ã>–æ–∫–Ω–∞ –ª–æ–º–∞—é—Ç –ø–∞—Ç—Ç–µ—Ä–Ω; reentrancy; manual trigger.
- ‚úÖ **PendingActionsService (pending call rejections)** ‚Äî `test/services/pending_actions_service_test.dart`
  - –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã: best-effort —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ; –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è; –ø–æ—Ä—è–¥–æ–∫; remove/clear; –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.
- ‚úÖ **IncomingCallBuffer (pre-offer ICE buffer)** ‚Äî `test/services/incoming_call_buffer_test.dart`
  - –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã: ensure –Ω–µ –æ—á–∏—â–∞–µ—Ç; –∏–∑–æ–ª—è—Ü–∏—è –ø–æ sender; takeAll –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç FIFO –∏ –æ—á–∏—â–∞–µ—Ç; clear –æ—á–∏—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ sender.
- ‚úÖ **CallStateService (call active flag)** ‚Äî `test/services/call_state_service_test.dart`
  - –ö–æ–Ω—Ç—Ä–∞–∫—Ç: `setCallActive` —É–≤–µ–¥–æ–º–ª—è–µ—Ç —Å–ª—É—à–∞—Ç–µ–ª–µ–π —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è.
- ‚úÖ **BackgroundCallService (foreground service during call)** ‚Äî `test/services/background_call_service_test.dart`
  - –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã: idempotent initialize; start/stop only when needed; updateNotification payload; best-effort (–Ω–µ –∫–∏–¥–∞–µ—Ç –Ω–∞—Ä—É–∂—É –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö backend).

---

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ —Ç–µ—Å—Ç—ã (–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç)

### 1. ChatScreen (chat_screen.dart) ‚ö†Ô∏è **–í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢**
**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ**: –ù–µ–¥–∞–≤–Ω–æ –±—ã–ª–∏ –≤–Ω–µ—Å–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç/–≤—Ä–µ–º–µ–Ω–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

**–ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**:
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –¥–∞—Ç–∞–º–∏ ("–°–µ–≥–æ–¥–Ω—è", "–í—á–µ—Ä–∞", –ø–æ–ª–Ω–∞—è –¥–∞—Ç–∞)
- ‚úÖ –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –¥–Ω–µ–π –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- ‚úÖ –°–∫—Ä—ã—Ç–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ–¥–Ω—É –º–∏–Ω—É—Ç—É
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π (–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ, –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ, –ø—Ä–æ—á–∏—Ç–∞–Ω–æ)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–≤–æ–Ω–∫–æ–≤ –≤ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞
- ‚úÖ –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–æ–≤—ã–º —Å–æ–æ–±—â–µ–Ω–∏—è–º
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞
- ‚úÖ –ê–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

**–§–∞–π–ª**: `test/widgets/chat_screen_test.dart`

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —á–∞—Å—Ç–∏—á–Ω–æ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–ü–æ–∫—Ä—ã—Ç–æ —Å–µ–π—á–∞—Å unit-—Ç–µ—Å—Ç–∞–º–∏ (–±–µ–∑ UI)**:
- –ø—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏/—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π/—Å–∫—Ä—ã—Ç–∏—è –≤—Ä–µ–º–µ–Ω–∏: `test/services/chat_time_rules_test.dart` (`lib/services/chat_time_rules.dart`)
- –ø—Ä–∞–≤–∏–ª–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏/–æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ (–∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–µ–∑ UI): `test/services/chat_session_controller_test.dart` (`lib/services/chat_session_controller.dart`)

---

### 2. AuthService (auth_service.dart) ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô**
**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ**: –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (PIN, duress code, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞).

**–ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**:
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PIN-–∫–æ–¥–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ PIN-–∫–æ–¥–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
- ‚úÖ Duress code (–∫–æ–¥ –ø—Ä–∏–Ω—É–∂–¥–µ–Ω–∏—è)
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ secure storage
- ‚úÖ –¢–∞–π–º–∞—É—Ç—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (lockout ladder)
- ‚úÖ Auto-wipe –ø–æ –ª–∏–º–∏—Ç—É –ø–æ–ø—ã—Ç–æ–∫

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–§–∞–π–ª**: `test/services/auth_service_test.dart`

---

### 3. NotificationService (notification_service.dart) ‚ö†Ô∏è **–í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢**
**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ**: –£–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –æ –∑–≤–æ–Ω–∫–∞—Ö –∏ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö.

**–ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**:
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è FCM
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è FCM —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–≤–æ–Ω–∫–∞—Ö
- ‚úÖ –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ–Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –ö–∞–Ω–∞–ª—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–§–∞–π–ª**: `test/services/notification_service_test.dart`

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —á–∞—Å—Ç–∏—á–Ω–æ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–ü–æ–∫—Ä—ã—Ç–æ —Å–µ–π—á–∞—Å unit-—Ç–µ—Å—Ç–∞–º–∏**:
- –ª–æ–∫–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: –∫–∞–Ω–∞–ª—ã + show/cancel (call/message), privacy (–±–µ–∑ —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è), best-effort –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –º–∞–ø–ø–∏–Ω–≥ background data-only —Å–æ–æ–±—â–µ–Ω–∏–π `type=call/message`

**–û—Å—Ç–∞–ª–æ—Å—å –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è**:
- FCM `init()` (requestPermission/getToken/tokenRefresh), onMessage/onMessageOpenedApp/getInitialMessage (–ø–æ—Ç—Ä–µ–±—É–µ—Ç DI –Ω–∞–¥ FirebaseMessaging –ø–æ—Ç–æ–∫–∞–º–∏)

---

### 4. WebRTCService (webrtc_service.dart) ‚ö†Ô∏è **–í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢**
**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ**: –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∞—É–¥–∏–æ–∑–≤–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ WebRTC - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

**–ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**:
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebRTC
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞—É–¥–∏–æ –ø–æ—Ç–æ–∫–∞ (–º–∏–∫—Ä–æ—Ñ–æ–Ω)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∞—É–¥–∏–æ –ø–æ—Ç–æ–∫–∞
- ‚úÖ ICE –∫–∞–Ω–¥–∏–¥–∞—Ç—ã (–æ—á–µ—Ä–µ–¥—å –¥–æ remote SDP / best-effort drain)
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–æ–º (speaker)

**–§–∞–π–ª**: `test/services/webrtc_service_test.dart`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (2025-12-27)**: –±–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç –æ—á–µ—Ä–µ–¥–∏ ICE –≤—ã–Ω–µ—Å–µ–Ω –≤ —á–∏—Å—Ç—ã–π –º–æ–¥—É–ª—å –∏ –ø–æ–∫—Ä—ã—Ç unit-—Ç–µ—Å—Ç–∞–º–∏:
- `lib/services/webrtc_candidate_queue.dart`
- `test/services/webrtc_candidate_queue_test.dart`

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–∏ —Å `WebRTCService` (ICE –¥–æ/–ø–æ—Å–ª–µ remote SDP + reset –Ω–∞ hangUp):
- `test/services/webrtc_service_queue_integration_test.dart`

---

### 5. CallScreen (call_screen.dart) ‚ö†Ô∏è **–í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢**
**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ**: –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω –¥–ª—è –∞—É–¥–∏–æ–∑–≤–æ–Ω–∫–æ–≤.

**–ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**:
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞
- ‚úÖ –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø—Ä–∏–Ω—è—Ç—å/–æ—Ç–∫–ª–æ–Ω–∏—Ç—å/–∑–∞–≤–µ—Ä—à–∏—Ç—å)
- ‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ (–≤–æ–ª–Ω—ã –∑–≤—É–∫–∞)
- ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∞ (speaker)
- ‚úÖ –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ UI —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ –¢–∞–π–º–µ—Ä –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–≤–æ–Ω–∫–∞

**–§–∞–π–ª**: `test/widgets/call_screen_smoke_test.dart`

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —á–∞—Å—Ç–∏—á–Ω–æ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–ü–æ–∫—Ä—ã—Ç–æ —Å–µ–π—á–∞—Å unit-—Ç–µ—Å—Ç–∞–º–∏ (—á–µ—Ä–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä)**:
- lifecycle –∑–≤–æ–Ω–∫–∞ (—Å—Ç–∞—Ä—Ç/–∑–∞–∫—Ä—ã—Ç–∏–µ —ç–∫—Ä–∞–Ω–∞) –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∞–π–¥‚Äë—ç—Ñ—Ñ–µ–∫—Ç—ã: callActive flag, hide call notification, start/stop foreground service
- –ø—Ä–∞–≤–∏–ª–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ signaling `hang-up` / `call-rejected` –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏/–∑–∞–∫—Ä—ã—Ç–∏–∏
- —Å–∏—Å—Ç–µ–º–Ω—ã–µ call‚Äëstatus —Å–æ–æ–±—â–µ–Ω–∏—è (–ª–æ–∫–∞–ª—å–Ω–æ + —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ —á–∞—Ç) –≤ –∫–ª—é—á–µ–≤—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö

**–§–∞–π–ª—ã**:
- `lib/services/call_session_controller.dart`
- `test/services/call_session_controller_test.dart`

**–ü–æ–∫—Ä—ã—Ç–æ widget-—Ç–µ—Å—Ç–∞–º–∏ (smoke/UI)**:
- –≤—Ö–æ–¥—è—â–∏–π/–∏—Å—Ö–æ–¥—è—â–∏–π —ç–∫—Ä–∞–Ω –±–µ–∑ –ø–∞–¥–µ–Ω–∏–π –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ (–±–µ–∑ WebRTC/–∞—É–¥–∏–æ –ø–ª–∞–≥–∏–Ω–æ–≤)
- –ø–∞–Ω–µ–ª—å –∫–Ω–æ–ø–æ–∫ (accept/reject/end, mic/speaker) ‚Äî `test/widgets/call_control_panel_test.dart`
- —Ñ–æ–Ω–æ–≤—ã–µ painter‚Äô—ã ‚Äî `test/widgets/call_background_painters_test.dart`

---

## üü° –í–∞–∂–Ω—ã–µ —Ç–µ—Å—Ç—ã (–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç)

### –°–µ—Ä–≤–∏—Å—ã

#### 6. BackgroundCallService (background_call_service.dart)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞–º–∏ –≤ —Ñ–æ–Ω–µ
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–≤–æ–Ω–∫–∞—Ö
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–≤–æ–Ω–∫–∞

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–§–∞–π–ª**: `test/services/background_call_service_test.dart`

#### 7. CallStateService (call_state_service.dart)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∑–≤–æ–Ω–∫–∞
- –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–§–∞–π–ª**: `test/services/call_state_service_test.dart`

#### 8. IncomingCallBuffer (incoming_call_buffer.dart)
- –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –∑–≤–æ–Ω–∫–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ ICE –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–æ offer
- –û—á–∏—Å—Ç–∫–∞ –±—É—Ñ–µ—Ä–∞

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–§–∞–π–ª**: `test/services/incoming_call_buffer_test.dart`

#### 9. PanicWipeService (panic_wipe_service.dart)
- –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–∞–Ω–∏–∫–∏ (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–∞–∂–∞—Ç–∏—è)
- –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –¢–∞–π–º–∞—É—Ç—ã –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–§–∞–π–ª**: `test/services/panic_wipe_service_test.dart`

#### 10. PendingActionsService (pending_actions_service.dart)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –≤ –æ—á–µ—Ä–µ–¥—å
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –û—á–∏—Å—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–§–∞–π–ª**: `test/services/pending_actions_service_test.dart`

#### 11. DeviceSettingsService (device_settings_service.dart)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫

**–§–∞–π–ª**: `test/services/device_settings_service_test.dart`

#### 12. ReleaseNotesService (release_notes_service.dart)
- –ó–∞–≥—Ä—É–∑–∫–∞ release notes
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª**: `test/services/release_notes_service_test.dart`

#### 13. DebugLoggerService (debug_logger_service.dart)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–æ–≤
- –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤

**–§–∞–π–ª**: `test/services/debug_logger_service_test.dart`

---

### –≠–∫—Ä–∞–Ω—ã

#### 14. QrScanScreen (qr_scan_screen.dart)
- –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ QR-–∫–æ–¥–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–§–∞–π–ª**: `test/widgets/qr_scan_screen_test.dart`

#### 15. LicenseScreen (license_screen.dart)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–∏—Ü–µ–Ω–∑–∏–∏
- –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞

**–§–∞–π–ª**: `test/widgets/license_screen_test.dart`

#### 16. UpdatesScreen (updates_screen.dart)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–µ—Ä—Å–∏—è–º

**–§–∞–π–ª**: `test/widgets/updates_screen_test.dart`

#### 17. LockScreen (screens/lock_screen.dart)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –í–≤–æ–¥ PIN-–∫–æ–¥–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ PIN
- Duress code

**–§–∞–π–ª**: `test/widgets/lock_screen_test.dart`

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

#### 18. PinSetupScreen (screens/pin_setup_screen.dart)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ PIN
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ PIN
- –í–∞–ª–∏–¥–∞—Ü–∏—è PIN
- –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

**–§–∞–π–ª**: `test/widgets/pin_setup_screen_test.dart`

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

#### 19. SecuritySettingsScreen (screens/security_settings_screen.dart)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ PIN
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ duress code
- –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

**–§–∞–π–ª**: `test/widgets/security_settings_screen_test.dart`

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

#### 20. SettingsScreen (screens/settings_screen.dart)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫

**–§–∞–π–ª**: `test/widgets/settings_screen_test.dart`

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —á–∞—Å—Ç–∏—á–Ω–æ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–ü–æ–∫—Ä—ã—Ç–æ —Å–µ–π—á–∞—Å**:
- smoke (—ç–∫—Ä–∞–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—É–Ω–∫—Ç—ã –≤–∏–¥–Ω—ã)
- –Ω–∞–≤–∏–≥–∞—Ü–∏—è –≤ ‚Äú–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å‚Äù
- —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –≤—Ö–æ–¥ –≤ ‚ÄúDEBUG LOGS‚Äù

#### 21. StatusScreen (screens/status_screen.dart)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–§–∞–π–ª**: `test/widgets/status_screen_test.dart`

#### 22. DebugLogsScreen (screens/debug_logs_screen.dart)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–æ–≥–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–æ–≤
- –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤
- –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤

**–§–∞–π–ª**: `test/widgets/debug_logs_screen_test.dart`

#### 23. HelpScreen (screens/help_screen.dart)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–∫–∏
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
- –ü–æ–∏—Å–∫ –≤ —Å–ø—Ä–∞–≤–∫–µ

**–§–∞–π–ª**: `test/widgets/help_screen_test.dart`

---

### –í–∏–¥–∂–µ—Ç—ã

#### 24. Call Control Panel (widgets/call/control_panel.dart)
- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–≤–æ–Ω–∫–æ–º
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞/–¥–∏–Ω–∞–º–∏–∫–∞
- –ê–Ω–∏–º–∞—Ü–∏–∏ –∫–Ω–æ–ø–æ–∫

**–§–∞–π–ª**: `test/widgets/call_control_panel_test.dart`

#### 25. Background Painters (widgets/call/background_painters.dart)
- –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ñ–æ–Ω–∞ –∑–≤–æ–Ω–∫–∞
- –ê–Ω–∏–º–∞—Ü–∏–∏ —Ñ–æ–Ω–∞
- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã

**–§–∞–π–ª**: `test/widgets/call_background_painters_test.dart`

---

### –ú–æ–¥–µ–ª–∏

#### 26. SecurityConfig (models/security_config.dart)
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–°—Ç–∞—Ç—É—Å**: ‚úÖ —Å–¥–µ–ª–∞–Ω–æ (2025-12-27)

**–§–∞–π–ª**: `test/models/security_config_test.dart`

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ - —Å–¥–µ–ª–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å):
1. **ChatScreen** - –Ω–µ–¥–∞–≤–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –¥–∞—Ç
2. **AuthService** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. **NotificationService** - –∫—Ä–∏—Ç–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ - —Å–¥–µ–ª–∞—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):
4. **WebRTCService** - –∞—É–¥–∏–æ–∑–≤–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ WebRTC
5. **CallScreen** - –æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω –∞—É–¥–∏–æ–∑–≤–æ–Ω–∫–æ–≤
6. **QrScanScreen** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ - —É–ª—É—á—à–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ):
7. –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
8. –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã
9. –í–∏–¥–∂–µ—Ç—ã –∏ –º–æ–¥–µ–ª–∏

---

## üéØ –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- **–°–µ—Ä–≤–∏—Å—ã**: 7 –∏–∑ 18 (39%)
- **–≠–∫—Ä–∞–Ω—ã**: 3 –∏–∑ 14 (21%)
- **–í–∏–¥–∂–µ—Ç—ã**: 1 –∏–∑ 3 (33%)
- **–ú–æ–¥–µ–ª–∏**: 2 –∏–∑ 3 (67%)

### –¶–µ–ª–µ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:
- **–°–µ—Ä–≤–∏—Å—ã**: 100% (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ), 80% (–æ—Å—Ç–∞–ª—å–Ω—ã–µ)
- **–≠–∫—Ä–∞–Ω—ã**: 100% (–æ—Å–Ω–æ–≤–Ω—ã–µ), 60% (–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ)
- **–í–∏–¥–∂–µ—Ç—ã**: 80%
- **–ú–æ–¥–µ–ª–∏**: 100%

---

## üìö –®–∞–±–ª–æ–Ω—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –∫–∞–∫ –ø—Ä–∏–º–µ—Ä—ã:
- `test/services/database_service_test.dart` - –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
- `test/widgets/contacts_screen_test.dart` - –¥–ª—è –≤–∏–¥–∂–µ—Ç–æ–≤
- `test/models/chat_message_model_test.dart` - –¥–ª—è –º–æ–¥–µ–ª–µ–π

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-01-27
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-01-27

